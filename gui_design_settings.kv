#:kivy 1.0.9
#:import HoverButton main.HoverButton

ScreenManager:
    MenuScreen:
        name: 'menu'
    CharacterCreation:
        name: 'character_creation'
    InGameScreen:
        name: 'ingame'

<MenuScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 100, 200, 100, 180
        canvas.before:
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'Program_Files/main_menu_background.jpg'

        HoverButton:
            text: 'New'
            font_name: 'Program_Files/medieval_font_file_2.ttf'
            font_size: 70
            size_hint: 0.2, 0.3
            pos_hint: {'center_x': 0.38}
            default_image: 'Program_Files/original_button_image.png'
            hover_image: 'Program_Files/new_game_button.png'
            on_press: root.change_to_chat()

        HoverButton:
            text: 'Load'
            font_name: 'Program_Files/medieval_font_file_2.ttf'
            font_size: 70
            size_hint: 0.2, 0.3
            pos_hint: {'center_x': 0.62}
            default_image: 'Program_Files/original_button_image.png'
            hover_image: 'Program_Files/load_game_button.png'
            on_press: app.stop()

        HoverButton:
            text: 'Die'
            font_size: 70
            font_name: 'Program_Files/medieval_font_file_2.ttf'
            size_hint: 0.2, 0.3
            pos_hint: {'center_x': 0.49}
            default_image: 'Program_Files/original_button_image.png'
            hover_image: 'Program_Files/exit_game_button.png'
            on_press: app.stop()

<CharacterCreation>:
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'Program_Files/character_creation/background_image.png'  # Ensure this image is in your folder
        
        BoxLayout:
            orientation: 'horizontal'
            size_hint: (1, 0.3)
            spacing: 20
            padding: [50, 0, 50, 0]
            
            ToggleButton:
                id: male_button
                group: 'gender'
                background_normal: 'Program_Files/character_creation_pics/male_symbol_v2.png'
                background_down: 'Program_Files/character_creation_pics/male_symbol_v3.png'
                on_press: root.select_gender('male')
            
            ToggleButton:
                id: female_button
                group: 'gender'
                background_normal: 'Program_Files/character_creation_pics/female_symbol_v2.png'
                background_down: 'Program_Files/character_creation_pics/female_symbol_v3.png'
                on_press: root.select_gender('female')

        BoxLayout:
            orientation: 'horizontal'
            size_hint: (1, 0.3)
            spacing: 20
            padding: [50, 0, 50, 0]

            ToggleButton:
                id: human_button
                group: 'species'
                background_normal: 'Program_Files/character_creation_pics/1class_warrior_symbol_v2.png'
                background_down: 'Program_Files/character_creation_pics/1class_warrior_symbol_v3.png'
                on_press: root.select_species('human')

            ToggleButton:
                id: elf_button
                group: 'species'
                background_normal: 'Program_Files/character_creation_pics/1class_warrior_symbol_v2.png'
                background_down: 'Program_Files/character_creation_pics/1class_warrior_symbol_v3.png'
                on_press: root.select_species('elf')

            ToggleButton:
                id: dwarf_button
                group: 'species'
                background_normal: 'Program_Files/character_creation_pics/1class_warrior_symbol_v2.png'
                background_down: 'Program_Files/character_creation_pics/1class_warrior_symbol_v3.png'
                on_press: root.select_species('dwarf')

        BoxLayout:
            orientation: 'horizontal'
            size_hint: (1, 0.3)
            spacing: 20
            padding: [50, 0, 50, 0]

            ToggleButton:
                id: warrior_button
                group: 'class'
                background_normal: 'Program_Files/character_creation_pics/1class_warrior_symbol_v2.png'
                background_down: 'Program_Files/character_creation_pics/1class_warrior_symbol_v3.png'
                on_press: root.select_class('warrior')

            ToggleButton:
                id: ranger_button
                group: 'class'
                background_normal: 'Program_Files/character_creation_pics/2class_ranger_symbol_v2.png'
                background_down: 'Program_Files/character_creation_pics/2class_ranger_symbol_v3.png'
                on_press: root.select_class('ranger')

            ToggleButton:
                id: mage_button
                group: 'class'
                background_normal: 'Program_Files/character_creation_pics/3class_mage_symbol_v2.png'
                background_down: 'Program_Files/character_creation_pics/3class_mage_symbol_v3.png'
                on_press: root.select_class('mage')

        BoxLayout:
            orientation: 'horizontal'
            size_hint: (1, 0.1)
            padding: [50, 20, 50, 20]
            spacing: 20
            
            Button:
                text: 'Back'
                on_release: app.root.current = 'menu'

            Button:
                id: create_button
                text: 'Create'
                disabled: True
                on_release: root.validate_selection()







<InGameScreen>:
    FloatLayout:
        BoxLayout:
            orientation: 'vertical'
            padding: 20
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                Rectangle:
                    source: 'Program_Files/in-game_background.png'
                    pos: self.pos
                    size: self.size

            BoxLayout:
                size_hint_y: None
                height: 40
                padding: 0
                spacing: 10  # Adjust spacing for better alignment
                pos_hint: {'top': 1}

                HoverButtonRounded:
                    text: 'Back'
                    size_hint: (None, None)
                    size: (120, 50)
                    font_size: 20
                    background_normal: ''
                    background_color: (0.4, 0.7, 0.7, 0)
                    on_release: root.go_back_to_menu(self)

                HoverButtonRounded:
                    text: 'Statistics'
                    size_hint: (None, None)
                    size: (120, 50)
                    font_size: 20
                    background_normal: ''
                    background_color: (0.4, 0.7, 0.7, 0)
                    on_release: root.toggle_panel('statistics')

                HoverButtonRounded:
                    text: 'Inventory'
                    size_hint: (None, None)
                    size: (120, 50)
                    font_size: 20
                    background_normal: ''
                    background_color: (0.4, 0.7, 0.7, 0)
                    on_release: root.toggle_panel('backpack', 'statistics')

                HoverButtonRounded:
                    text: 'Save'
                    size_hint: (None, None)
                    size: (120, 50)
                    font_size: 20
                    background_normal: ''
                    background_color: (0.4, 0.7, 0.7, 0)

                HoverButtonRounded:
                    text: 'Load'
                    size_hint: (None, None)
                    size: (120, 50)
                    font_size: 20
                    background_normal: ''
                    background_color: (0.4, 0.7, 0.7, 0)

                HoverButtonRounded:
                    text: 'Exit'
                    size_hint: (None, None)
                    size: (120, 50)
                    font_size: 20
                    background_normal: ''
                    background_color: (0.4, 0.7, 0.7, 0)
                    on_release: root.exit_app(self)

            # Main content area
            BoxLayout:
                orientation: 'vertical'
                size_hint: (1, 0.9)

                Label:
                    id: output_label
                    size_hint: (1, 0.8)
                    font_size: 16
                    color: (1, 1, 1, 1)
                    outline_width: 0
                    outline_color: (0, 0, 0, 0)
                    text_size: (self.width - 40, None)
                    padding: (0, 600, 0, 0)
                    valign: 'top'
                    halign: 'left'

                TextInput:
                    id: input_text
                    size_hint: (1, 0.045)
                    font_size: 30
                    font_name: 'Program_Files/medieval_font_file.ttf'
                    background_color: (1, 1, 1, 1)
                    multiline: False
                    padding: (15, 10, 15, 10)
                    on_text_validate: root.on_text_enter(self)

                       
        # Statistics panel (initially hidden)
        FloatLayout:
            id: statistics
            size_hint: (0.61, 0.60)
            pos: (20, 307) # Using pos with fixed value bc pos_hint doesnt work 
            orientation: 'vertical'
            padding: 10
            canvas.before:
                Color:
                    rgba: 0, 0, 0, 0.7
                Rectangle:
                    pos: self.pos
                    size: self.size
            opacity: 0  # Initially hidden
            disabled: True  # Initially disabled

            BoxLayout:
                orientation: 'vertical'
                size_hint: None, None
                size: self.minimum_size
                pos_hint: {'x': 0, 'top': 1}  # Align to top left

                Label:
                    text: 'Satistics'
                    color: (1, 1, 1, 1)
                    font_size: 20
                    size_hint: None, None
                    size: self.texture_size
            
      
        # Backpack panel (initially hidden)
        FloatLayout:  
            id: backpack
            size_hint: (0.34, 0.66)
            pos_hint: {'right': 0.982, 'top': 0.98}
            orientation: 'vertical'
            padding: 10
            canvas.before:
                Color:
                    rgba: 0, 0, 0, 0.7
                Rectangle:
                    pos: self.pos
                    size: self.size
            opacity: 0  # Initially hidden
            disabled: True  # Initially disabled

            BoxLayout:
                orientation: 'vertical'
                size_hint: None, None
                size: self.minimum_size
                pos_hint: {'x': 0, 'top': 1}  # Align to top left

                Label:
                    text: 'Backpack'
                    color: (1, 1, 1, 1)
                    font_size: 20
                    size_hint: None, None
                    size: self.texture_size

                # Horizontal BoxLayout for item buttons
                BoxLayout:
                    orientation: 'horizontal'
                    size_hint: None, None
                    size: self.minimum_size

                    # Item buttons
                    Button:
                        text: 'Item 1'
                        size_hint: None, None
                        size: 96, 96

                    Button:
                        text: 'Item 2'
                        size_hint: None, None
                        size: 96, 96

                    Button:
                        text: 'Item 3'
                        size_hint: None, None
                        size: 96, 96


<HoverButton@Button>:
    background_color: 0, 0, 0, 0
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: self.default_image