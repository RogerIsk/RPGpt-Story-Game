#:kivy 1.0.9
#:import HoverButton main.HoverButton

ScreenManager:
    MenuScreen:
        name: 'menu'
    CharacterCreation:
        name: 'character_creation'
    InGameScreen:
        name: 'ingame'

<MenuScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 100, 200, 100, 180
        canvas.before:
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'Program_Files/main_menu_background.jpg'

        HoverButton:
            text: 'New'
            font_name: 'Program_Files/medieval_font_file_2.ttf'
            font_size: 70
            size_hint: 0.2, 0.3
            pos_hint: {'center_x': 0.38}
            default_image: 'Program_Files/original_button_image.png'
            hover_image: 'Program_Files/new_game_button.png'
            background_color: [0, 0, 0, 0]
            background_normal: ''
            on_press: root.change_to_chat()

        HoverButton:
            text: 'Load'
            font_name: 'Program_Files/medieval_font_file_2.ttf'
            font_size: 70
            size_hint: 0.2, 0.3
            pos_hint: {'center_x': 0.62}
            default_image: 'Program_Files/original_button_image.png'
            hover_image: 'Program_Files/load_game_button.png'
            background_color: [0, 0, 0, 0]
            background_normal: ''
            on_press: app.stop()

        HoverButton:
            text: 'Die'
            font_size: 70
            font_name: 'Program_Files/medieval_font_file_2.ttf'
            size_hint: 0.2, 0.3
            pos_hint: {'center_x': 0.49}
            default_image: 'Program_Files/original_button_image.png'
            hover_image: 'Program_Files/exit_game_button.png'
            background_color: [0, 0, 0, 0]
            background_normal: ''
            on_press: app.stop()

<CharacterCreation>:
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'Program_Files/character_creation_images/background_image.gif'  # Changed to .gif
    
        BoxLayout:
            orientation: 'horizontal'
            size_hint: (1, 0.3)
            spacing: 20
            padding: [50, 0, 50, 0]

            RelativeLayout:
                Image:
                    id: female_gif
                    source: 'Program_Files/character_creation_images/1_inactive_female.gif'
                    anim_delay: 0.1
                    allow_stretch: True
                    keep_ratio: True

                ToggleButton:
                    id: female_button
                    group: 'gender'
                    background_color: (0, 0, 0, 0)
                    background_normal: ''
                    on_press: root.select_gender('female')

            RelativeLayout:
                Image:
                    id: male_gif
                    source: 'Program_Files/character_creation_images/2_inactive_male.gif'
                    anim_delay: 0.1
                    allow_stretch: True
                    keep_ratio: True

                ToggleButton:
                    id: male_button
                    group: 'gender'
                    background_color: (0, 0, 0, 0)
                    background_normal: ''
                    on_press: root.select_gender('male')

        BoxLayout:
            orientation: 'horizontal'
            size_hint: (1, 0.3)
            spacing: 20
            padding: [50, 0, 50, 0]

            RelativeLayout:
                Image:
                    id: human_gif
                    source: 'Program_Files/character_creation_images/3_inactive_human.gif'
                    anim_delay: 0.1
                    allow_stretch: True
                    keep_ratio: True

                ToggleButton:
                    id: human_button
                    group: 'species'
                    background_color: (0, 0, 0, 0)
                    background_normal: ''
                    on_press: root.select_species('human')

            RelativeLayout:
                Image:
                    id: elf_gif
                    source: 'Program_Files/character_creation_images/4_inactive_elf.gif'
                    anim_delay: 0.1
                    allow_stretch: True
                    keep_ratio: True

                ToggleButton:
                    id: elf_button
                    group: 'species'
                    background_color: (0, 0, 0, 0)
                    background_normal: ''
                    on_press: root.select_species('elf')

            RelativeLayout:
                Image:
                    id: dwarf_gif
                    source: 'Program_Files/character_creation_images/5_inactive_dwarf.gif'
                    anim_delay: 0.1
                    allow_stretch: True
                    keep_ratio: True

                ToggleButton:
                    id: dwarf_button
                    group: 'species'
                    background_color: (0, 0, 0, 0)
                    background_normal: ''
                    on_press: root.select_species('dwarf')

        BoxLayout:
            orientation: 'horizontal'
            size_hint: (1, 0.3)
            spacing: 20
            padding: [50, 0, 50, 0]

            RelativeLayout:
                Image:
                    id: warrior_gif
                    source: 'Program_Files/character_creation_images/6_inactive_warrior.gif'
                    anim_delay: 0.1
                    allow_stretch: True
                    keep_ratio: True

                ToggleButton:
                    id: warrior_button
                    group: 'class'
                    background_color: (0, 0, 0, 0)
                    background_normal: ''
                    on_press: root.select_class('warrior')

            RelativeLayout:
                Image:
                    id: ranger_gif
                    source: 'Program_Files/character_creation_images/7_inactive_ranger.gif'
                    anim_delay: 0.1
                    allow_stretch: True
                    keep_ratio: True

                ToggleButton:
                    id: ranger_button
                    group: 'class'
                    background_color: (0, 0, 0, 0)
                    background_normal: ''
                    on_press: root.select_class('ranger')

            RelativeLayout:
                Image:
                    id: mage_gif
                    source: 'Program_Files/character_creation_images/8_inactive_mage.gif'
                    anim_delay: 0.1
                    allow_stretch: True
                    keep_ratio: True

                ToggleButton:
                    id: mage_button
                    group: 'class'
                    background_color: (0, 0, 0, 0)
                    background_normal: ''
                    on_press: root.select_class('mage')

        BoxLayout:
            orientation: 'horizontal'
            size_hint: (1, 0.1)
            padding: [50, 20, 50, 20]
            spacing: 20
            
            HoverButtonRounded:
                text: 'Back'
                on_release: app.root.current = 'menu'
                background_color: [0, 0, 0, 0]
                background_normal: ''

            HoverButtonRounded:
                text: 'Random'
                on_release: root.random_selection()  # Calls the new random selection method
                background_color: [0, 0, 0, 0]
                background_normal: ''

            HoverButtonRounded:
                id: create_button
                text: 'Create'
                disabled: True
                on_release: root.validate_selection()
                background_color: [0.5, 0.5, 0.5, 0]
                background_normal: ''
        


<InGameScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        canvas.before:
            Rectangle:
                source: 'Program_Files/in-game_background.png'
                pos: self.pos
                size: self.size

        BoxLayout:
            size_hint_y: None
            height: 40
            padding: 0
            spacing: 10
            pos_hint: {'top': 1}

            HoverButtonRounded:
                text: 'Back'
                size_hint: (None, None)
                size: (120, 50)
                font_size: 20
                background_color: [0, 0, 0, 0]
                background_normal: ''
                on_release: root.go_back_to_menu(self)

            HoverButtonRounded:
                text: 'Statistics'
                size_hint: (None, None)
                size: (120, 50)
                font_size: 20
                background_color: [0, 0, 0, 0]
                background_normal: ''

            HoverButtonRounded:
                text: 'Inventory'
                size_hint: (None, None)
                size: (120, 50)
                font_size: 20
                background_color: [0, 0, 0, 0]
                background_normal: ''

            HoverButtonRounded:
                text: 'History'
                size_hint: (None, None)
                size: (120, 50)
                font_size: 20
                background_color: [0, 0, 0, 0]
                background_normal: ''

            HoverButtonRounded:
                text: 'Load'
                size_hint: (None, None)
                size: (120, 50)
                font_size: 20
                background_color: [0, 0, 0, 0]
                background_normal: ''

            HoverButtonRounded:
                text: 'Save'
                size_hint: (None, None)
                size: (120, 50)
                font_size: 20
                background_color: [0, 0, 0, 0]
                background_normal: ''

            HoverButtonRounded:
                text: 'Exit'
                size_hint: (None, None)
                size: (120, 50)
                font_size: 20
                background_color: [0, 0, 0, 0]
                background_normal: ''
                on_release: root.exit_app(self)

        BoxLayout:
            orientation: 'vertical'
            size_hint: (1, 0.9)

            Label:
                id: output_label
                size_hint: (1, 0.8)
                font_size: 16
                color: (1, 1, 1, 1)
                valign: 'top'
                halign: 'left'

            TextInput:
                id: input_text
                size_hint: (1, 0.045)
                font_size: 30
                multiline: False
                padding: (15, 10, 15, 10)
                on_text_validate: root.on_text_enter(self)